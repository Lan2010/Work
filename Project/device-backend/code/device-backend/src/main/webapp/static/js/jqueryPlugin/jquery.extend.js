define(["jquery"],function(v){"use strict";v.extend({cookie:function(e,t,i){if("object"==typeof t||"function"==typeof t)return console.log("[Cookie] value can not be Object or Function"),"";if(i=i||{},e&&null!=t){if(""===t&&(i.expires=-1),"number"==typeof i.expires){var n=i.expires,a=i.expires=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*n)}return document.cookie=[encodeURIComponent(e),"=",encodeURIComponent(t),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join(""),""}if(e&&void 0===t){for(var o="",l=document.cookie?document.cookie.split("; "):[],s=l.length,r=0;r<s;r++){var d=l[r].split("=");if(e===decodeURIComponent(d[0])){o=decodeURIComponent(d[1]);break}}return o}},date:function(e,t){var i=e||0,n=e||{},a=e||"",o="",l="",s="",r="",d="",h="";return e&&("string"==typeof e?i=(n=new Date(e.replace(/-/g,"/"))).getTime():"number"==typeof e?(n=new Date(e),i=e):"object"==typeof e&&(i=(n=e).getTime()),t&&(i+=1e3*t,n=null,n=new Date(i)),a=(o=n.getFullYear())+"-"+(l=(l=n.getMonth()+1)<10?"0"+l:l)+"-"+(s=(s=n.getDate())<10?"0"+s:s)+" "+(r=(r=n.getHours())<10?"0"+r:r)+":"+(d=(d=n.getMinutes())<10?"0"+d:d)+":"+(h=(h=n.getSeconds())<10?"0"+h:h)),{timeStamp:i,stardard:n,string:a,ymd:o+"-"+l+"-"+s,year:o,month:l,day:s,hour:r,minute:d,second:h}},convertMS:function(e,t){if(e){"number"!=typeof e&&(e=parseFloat(e));var i=Math.floor(e/864e5),n=e%864e5,a=Math.floor(n/36e5),o=n%36e5,l=Math.floor(o/6e4),s=o%6e4,r=Math.round(s/1e3);return 6e4<=e?(0===i?"":i+"天 ")+(0===a?"":a+"小时 ")+(0===l?"":l+"分钟 "):0===r?"":r+"秒"}return 0==e?"0秒":e},enCodeText:function(e){return e&&"string"==typeof e&&(e=(e=e.replace(/</gi,"&lt;")).replace(/>/gi,"&gt;")),e},deCodeText:function(e){return e&&"string"==typeof e&&(e=(e=e.replace(/&lt;/gi,"<")).replace(/&gt;/gi,">")),e},isJson:function(e){return!!e&&/^[\],:{}\s]*$/.test(e.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))},isInit:function(e){return/^[0-9]+$/.test(e)},getAllParam:function(e){var t,i,n,a=(e=e||window.location.href).split("?"),o=(a=(a=a[1]?a[1].split("#")[0]:"")?a.split("&"):[]).length,l={};if(o){for(var s=0;s<o;s++)a[s]&&(i=(t=a[s].split("="))[0],n=t[1],2<t.length&&(t.shift(),n=t.join("=")),l[i]=n?decodeURIComponent(n):"");e||(this.urlParameters=l)}return l},getParam:function(e){var t=null!=this.urlParameters?this.urlParameters:this.getAllParam();return e&&t[e]?t[e]:""}}),v.fn.loading=function(e){if(0!=e){var t=v('<div class="page-load"><div class="page-mask-transparent"></div><div class="page-loading"><div class="icon-loading"></div></div></div>');v(this).append(t)}else v(this).find(">.page-load").remove()},v.fn.msg=function(e,t){"[object Object]"===Object.prototype.toString.call(e)&&(t=v.extend({},e),e="msg");var i=v(this),n=["icon-loading","fa fa-warning","fa fa-times-circle","fa fa-check-circle"],a={level:"main",text:"loading"==(e=e||"msg")?"数据加载中":e,icon:"loading"==e&&n[0]||"tip"==e&&n[1]||"error"==e&&n[2]||"success"==e&&n[3]||"",mask:"loading"==e,time:0,close:!0},o=t?v.extend(a,t):a,l=function(e){var t=v(this);(e=t.data()).sto&&clearTimeout(e.sto),e.msg&&e.msg.remove(),e.mask&&e.mask.remove(),t.data({sto:"",msg:"",mask:""})};if(l.call(i),"hide"!=e){var s,r=v(['<div class="msg msg-'+e+" "+("top"==o.level?"msg-top":"")+'">','<div class="msg-cell">','<div class="msg-main">',o.icon?'<i class="msg-icon '+o.icon+'"></i>':"",'<div class="msg-content"></div>',"</div>","</div>","</div>"].join("")),d=r.find(".msg-cell"),h=r.find(".msg-content"),c=o.mask?v('<div class="page-mask-msg '+("top"==o.level?"top":"")+'"></div>'):"";if(i.append(c).append(r).data({msg:r,mask:c}),h.html(o.text),d.css("top",-d.height()/2+"px"),r.show(),o.time&&(s=setTimeout(function(){l.call(i)},o.time),i.data("sto",s)),"error"==e&&o.close&&r.find(".msg-cell").on("click",function(e){l.call(i),e.preventDefault()}),"page"==e){var p=v('<div class="msg-close"><i class="fa fa-times"></i></div>');r.append(p),p.on("click",function(e){l.call(i),e.preventDefault()})}return i}},v.fn.oResize=function(t){var i={width:v(window).width(),height:v(window).height()};return this.each(function(){this===window?v(this).resize(function(e){if(function(){if(navigator.appVersion.match(/MSIE 7.0|MSIE 6.0|MSIE 8.0/i)){var e=v(window).width(),t=v(window).height();if(e===i.width&&t===i.height)return!1;i.width=e,i.height=t}else i.width=v(window).width();return!0}())return t.apply(this,[e,i.width])}):v(this).resize(t)}),this},v.fn.setRadio=function(e){var o=v(this),l=v.extend({id:"id",name:"name",value:"",def:!1},e);return v.extend(l,{dataType:"json",cache:!1,success:function(e){if("[object Object]"==Object.prototype.toString.call(e)&&"[object Array]"==Object.prototype.toString.call(e.data)){for(var t="",i=e.data,n=0,a=i.length;n<a;n++)t+='<label class="radio-inline"><input name="'+o.attr("data-name")+'" type="radio" value="'+i[n][l.id]+'" '+(l.value==i[n][l.id]?"checked":"")+"><i></i><span>"+i[n][l.name]+"</span></label>";o.html(t),l.def&&o.find("input").first().prop("checked",!0)}},error:function(){}}),v.ajax(l)},v.fn.setSelect=function(e){var l=this,r=v(this),t=r.data(),d=v.extend({value:"",id:"id",name:"name",relate:[],text:t.text?t.text:"",textNodata:t.textnodata?t.textnodata:"无数据",def:!0,group:!1,onChangeAll:!1,onChange:null},e);return"[object Function]"===Object.prototype.toString.call(d.onChange)&&r.off("change").on("change",function(){var e=v(this).val()||"",t=e?v(this).data(""+e):"";(e||!e&&d.onChangeAll)&&d.onChange.call(l,e,t?{id:t[d.id],name:t[d.name]}:{});var i=d.relate.length;if(!e&&i)for(var n=0;n<i;n++)if(d.relate[n]){var a=v(d.relate[n]),o=a.data("emptytext");null!=o?a.html('<option value="">'+o+"</option>"):a.html("")}}),v.extend(d,{dataType:"json",cache:!1,success:function(e){if("[object Object]"==Object.prototype.toString.call(e)&&"[object Array]"==Object.prototype.toString.call(e.data)){var t,i,n=e.data,a=n.length;if(t=d.def?'<option value="" selected>'+d.text+"</option>":"",a)for(var o=0;o<a;o++)if(d.group){t+='<optgroup label="'+n[o][d.name]+'">';for(var l=0,s=(i=n[o].data?n[o].data:[]).length;l<s;l++)t+='<option value="'+i[l][d.id]+'">'+i[l][d.name]+"</option>",r.data(""+i[l][d.id],i[l]);t+="</optgroup>"}else t+='<option value="'+n[o][d.id]+'">'+n[o][d.name]+"</option>",r.data(""+n[o][d.id],n[o]);else t='<option value="" selected>'+d.textNodata+"</option>";r.html(t),null!=d.value&&r.val(d.value),d.value||d.def||r.find("option").first().prop("selected",!0),r.trigger("change"),d.onComplete&&d.onComplete(n)}},error:function(e,t,i){}}),v.ajax(d)},v.fn.fillForm=function(e,t,i){"[object Function]"===Object.prototype.toString.call(t)&&(i=t,t={});var n=v.extend(!0,{fields:[]},t),a=v(this),o=n.fields;if(!o.length)for(var l in e)o.push(l);for(var s=0,r=o.length;s<r;s++){var d=o[s],h=e[d];if("[object Object]"===Object.prototype.toString.call(d))for(var l in d)h=d[l],d=l;var c=a.find('*[name="'+d+'"]');if(void 0!==h&&c.length){var p=c.get(0).tagName;if(h=(h=v.trim(h))||"","INPUT"==p||"SELECT"==p||"TEXTAREA"==p){var f=c.attr("type");if("radio"==f){c.filter('[value="'+h+'"]').prop("checked",!0);continue}if("checkbox"==f){for(var u=h.split(","),m=0,g=u.length;m<g;m++)c.filter('[value="'+v.trim(u[m])+'"]').prop("checked",!0);continue}c.val(h)}else{if("IMG"==p){c.attr("src",h);continue}c.html(h)}}}return i&&i(),v(this)},v.fn.packJson=function(e){var u=v.extend({type:"object",checkbox:"string",sep:".",nullVal:!0,hidden:!0,shown:!0,filter:[]},e),t=v(this),m={};v(":input",t).each(function(e){var t,i,n=v(this),a=n.attr("name"),o=n.attr("type"),l=n.val(),s=n.prop("checked");if("text"===o&&""===(l=v.trim(l))&&n.val(""),n.is("button")||!a||0<=u.filter.toString().indexOf(a))return!0;if(!u.shown&&"hidden"!=o||!u.hidden&&"hidden"===o||!u.nullVal&&(!l||("checkbox"===o||"radio"===o)&&!s)||"true"===n.attr("data-ignore"))return!0;t=l,"number"===(i=n.attr("data-type"))?t=parseFloat(t)?parseFloat(t):0:"array"===i&&(t=t?t.split(","):[]),l=t;var r=m,d=a;if(u.sep&&0<a.indexOf(u.sep))for(var h=a.split(u.sep),c=0,p=h.length;c<p;c++)d=h[c],c<p-1&&(r[d]||(r[d]={}),r=r[d]);if("checkbox"===o){if(void 0===r[d]&&(r[d]="array"===u.checkbox?[]:""),s)if("array"===u.checkbox)r[d].push(l);else{var f=n.attr("data-sep");f=void 0===f?",":f,r[d]+=(""!=r[d]?f:"")+l}}else r[d]="radio"===o?s?l:void 0===r[d]?"":r[d]:l});var i=JSON.stringify(m);return/^\{\}$/.test(i)?"":"string"===u.type?i:m};var n=function(e,t){if(this.$element=v(e),this.type=this.$element.data("uploadtype")||(0<this.$element.find(".thumbnail").length?"image":"file"),this.$input=this.$element.find(":file"),0!==this.$input.length){this.name=this.$input.attr("name")||t.name,this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]'),0===this.$hidden.length&&(this.$hidden=v('<input type="hidden" />'),this.$element.prepend(this.$hidden)),this.$preview=this.$element.find(".fileupload-preview");var i=this.$preview.css("height");"inline"!=this.$preview.css("display")&&"0px"!=i&&"none"!=i&&this.$preview.css("line-height",i),this.$thumbnail=this.$element.find(".thumbnail"),this.original={exists:this.$element.hasClass("fileupload-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()},this.$remove=this.$element.find('[data-dismiss="fileupload"]'),this.$element.find('[data-trigger="fileupload"]').on("click.fileupload",v.proxy(this.trigger,this)),this.listen()}};n.prototype={listen:function(){this.$input.on("change.fileupload",v.proxy(this.change,this)),v(this.$input[0].form).on("reset.fileupload",v.proxy(this.reset,this)),this.$remove&&this.$remove.on("click.fileupload",v.proxy(this.clear,this))},change:function(e,t){var i=void 0!==e.target.files?e.target.files[0]:e.target.value?{name:e.target.value.replace(/^.+\\/,"")}:null;if("clear"!==t)if(i){if(this.$hidden.val(""),this.$hidden.attr("name",""),this.$input.attr("name",this.name),"image"===this.type&&(void 0!==i.type?i.type.match("image.*"):i.name.match("\\.(gif|png|jpe?g)$"))&&"undefined"!=typeof FileReader){var n=new FileReader,a=this.$preview,o=this.$thumbnail,l=this.$element;n.onload=function(e){o.html('<img src="'+e.target.result+'" />').show(),a.text(i.name),l.addClass("fileupload-exists").removeClass("fileupload-new").addClass("fileupload-thumbnail")},n.readAsDataURL(i)}else this.$thumbnail.hide(),this.$preview.text(i.name),this.$element.addClass("fileupload-exists").removeClass("fileupload-new").removeClass("fileupload-thumbnail");this.$input.focus()}else this.clear()},clear:function(e){if(this.$hidden.val(""),this.$hidden.attr("name",this.name),this.$input.attr("name",""),/msie/.test(navigator.userAgent.toLowerCase())){var t=this.$input.clone(!0);this.$input.after(t),this.$input.remove(),this.$input=t}else this.$input.val("");this.$thumbnail.html("").hide(),this.$preview.html(""),this.$element.addClass("fileupload-new").removeClass("fileupload-exists").removeClass("fileupload-thumbnail"),e&&(this.$input.trigger("change",["clear"]),e.preventDefault())},reset:function(e){this.clear(),this.$hidden.val(this.original.hiddenVal),this.$preview.html(this.original.preview),this.original.exists?this.$element.addClass("fileupload-exists").removeClass("fileupload-new"):this.$element.addClass("fileupload-new").removeClass("fileupload-exists")},trigger:function(e){this.$input.trigger("click"),e.preventDefault()}},v.fn.fileupload=function(i){return this.each(function(){var e=v(this),t=e.data("fileupload");t||e.data("fileupload",t=new n(this,i)),"string"==typeof i&&t[i]()})},v.fn.fileupload.Constructor=n});