define(function(){"use strict";var u={extend:function(e){if("[object Object]"===Object.prototype.toString.call(e))for(var o in e){var t=e[o];this!==e[o]&&(this[o]=t)}return this},oldPath:"",newPath:"",routes:{},onlyHashing:!1,updateHash:function(e){if(e){var o=window.location.href.split("#"),t=o[1];if(t)((t=t.split("?"))[1]?t[1]:"")!=(e=$.param(e))&&(this.onlyHashing=!0,window.location.href=o[0]+"#"+t[0]+(e?"?"+e:""))}},start:function(){"onhashchange"in window&&(void 0===document.documentMode||7<document.documentMode)?(!0===window.history?setTimeout(function(){window.onpopstate=e},300):window.onhashchange=e,window.mode="modern"):console.log("[Auth System] Sorry, your browser doesn't support route"),e()}},e=function(e){if(u.onlyHashing)u.onlyHashing=!1;else{var o,t=e&&e.oldURL||"",n=e&&e.newURL||window.location.href,i=/.*#/.test(t)?t.replace(/.*#/,""):"",r=/.*#/.test(n)?n.replace(/.*#/,""):"",s=r?u.routes["*"]:"",a=[];for(var c in u.routes)if("*"!=c){var l=(o=(o=c).replace(/[\-{}\[\]+?.,\\\^$|#\s]/g,"\\$&").replace(/\((.*?)\)/g,"(?:$1)?").replace(/(\(\?)?:\w+/g,function(e,o){return o?e:"([^/?]+)"}).replace(/\*\w+/g,"([^?]*?)"),new RegExp("^"+o+"(?:\\?([\\s\\S]*))?$")).exec(r);l&&1<l.length&&(s=u.routes[c],a=l.slice(1))}i=i?i.split("?")[0]:i,r=r?r.split("?")[0]:r,s&&u[s]&&u[s].call(u,a,r,i)}};return u});