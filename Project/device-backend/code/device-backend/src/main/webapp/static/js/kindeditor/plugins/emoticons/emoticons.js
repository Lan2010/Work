KindEditor.plugin("emoticons",function(b){var w=this,e="emoticons",C=w.emoticonsPath||w.pluginsPath+"emoticons/images/",i=void 0===w.allowPreviewEmoticons||w.allowPreviewEmoticons,P=1;w.clickToolbar(e,function(){var l,o,p=5,u=9,d=0,f=p*u,s=Math.ceil(135/f),a=Math.floor(u/2),t=b('<div class="ke-plugin-emoticons"></div>'),v=[];function m(e,i,n){l?e.mouseover(function(){a<i?(l.css("left",0),l.css("right","")):(l.css("left",""),l.css("right",0)),o.attr("src",C+n+".gif"),b(this).addClass("ke-on")}):e.mouseover(function(){b(this).addClass("ke-on")}),e.mouseout(function(){b(this).removeClass("ke-on")}),e.click(function(e){w.insertHtml('<img src="'+C+n+'.gif" border="0" alt="" />').hideMenu().focus(),e.stop()})}function n(e,i){var n=document.createElement("table");i.append(n),l&&(b(n).mouseover(function(){l.show("block")}),b(n).mouseout(function(){l.hide()}),v.push(b(n))),n.className="ke-table",n.cellPadding=0,n.cellSpacing=0,n.border=0;for(var o=(e-1)*f+d,s=0;s<p;s++)for(var a=n.insertRow(s),t=0;t<u;t++){var c=b(a.insertCell(t));c.addClass("ke-cell"),m(c,t,o);var r=b('<span class="ke-img"></span>').css("background-position","-"+24*o+"px 0px").css("background-image","url("+C+"static.gif)");c.append(r),v.push(c),o++}return n}w.createMenu({name:e,beforeRemove:function(){g()}}).div.append(t),i&&(l=b('<div class="ke-preview"></div>').css("right",0),o=b('<img class="ke-preview-img" src="'+C+d+'.gif" />'),t.append(l),l.append(o));var c,r=n(P,t);function g(){b.each(v,function(){this.unbind()})}function h(e,i){e.click(function(e){g(),r.parentNode.removeChild(r),c.remove(),r=n(i,t),k(i),P=i,e.stop()})}function k(e){c=b('<div class="ke-page"></div>'),t.append(c);for(var i=1;i<=s;i++){if(e!==i){var n=b('<a href="javascript:;">['+i+"]</a>");h(n,i),c.append(n),v.push(n)}else c.append(b("@["+i+"]"));c.append(b("@&nbsp;"))}}k(P)})});