KindEditor.plugin("flash",function(s){var h=this,p="flash",g=h.lang(p+"."),f=s.undef(h.allowFlashUpload,!0),c=s.undef(h.allowFileManager,!1),v=s.undef(h.formatUploadUrl,!0),m=s.undef(h.extraFileUploadParams,{}),k=s.undef(h.filePostName,"imgFile"),b=s.undef(h.uploadJson,h.basePath+"php/upload_json.php");h.plugin.flash={edit:function(){var e=['<div style="padding:20px;">','<div class="ke-dialog-row">','<label for="keUrl" style="width:60px;">'+g.url+"</label>",'<input class="ke-input-text" type="text" id="keUrl" name="url" value="" style="width:160px;" /> &nbsp;','<input type="button" class="ke-upload-button" value="'+g.upload+'" /> &nbsp;','<span class="ke-button-common ke-button-outer">','<input type="button" class="ke-button-common ke-button" name="viewServer" value="'+g.viewServer+'" />',"</span>","</div>",'<div class="ke-dialog-row">','<label for="keWidth" style="width:60px;">'+g.width+"</label>",'<input type="text" id="keWidth" class="ke-input-text ke-input-number" name="width" value="550" maxlength="4" /> ',"</div>",'<div class="ke-dialog-row">','<label for="keHeight" style="width:60px;">'+g.height+"</label>",'<input type="text" id="keHeight" class="ke-input-text ke-input-number" name="height" value="400" maxlength="4" /> ',"</div>","</div>"].join(""),t=h.createDialog({name:p,width:450,title:h.lang(p),body:e,yesBtn:{name:h.lang("yes"),click:function(e){var a=s.trim(n.val()),t=o.val(),l=d.val();if("http://"==a||s.invalidUrl(a))return alert(h.lang("invalidUrl")),void n[0].focus();if(!/^\d*$/.test(t))return alert(h.lang("invalidWidth")),void o[0].focus();if(!/^\d*$/.test(l))return alert(h.lang("invalidHeight")),void d[0].focus();var i=s.mediaImg(h.themesPath+"common/blank.gif",{src:a,type:s.mediaType(".swf"),width:t,height:l,quality:"high"});h.insertHtml(i).hideDialog().focus()}}}),l=t.div,n=s('[name="url"]',l),a=s('[name="viewServer"]',l),o=s('[name="width"]',l),d=s('[name="height"]',l);if(n.val("http://"),f){var i=s.uploadbutton({button:s(".ke-upload-button",l)[0],fieldName:k,extraParams:m,url:s.addParam(b,"dir=flash"),afterUpload:function(e){if(t.hideLoading(),0===e.error){var a=e.url;v&&(a=s.formatUrl(a,"absolute")),n.val(a),h.afterUpload&&h.afterUpload.call(h,a,e,p),alert(h.lang("uploadSuccess"))}else alert(e.message)},afterError:function(e){t.hideLoading(),h.errorDialog(e)}});i.fileBox.change(function(e){t.showLoading(h.lang("uploadLoading")),i.submit()})}else s(".ke-upload-button",l).hide();c?a.click(function(e){h.loadPlugin("filemanager",function(){h.plugin.filemanagerDialog({viewType:"LIST",dirName:"flash",clickFn:function(e,a){1<h.dialogs.length&&(s('[name="url"]',l).val(e),h.afterSelectFile&&h.afterSelectFile.call(h,e),h.hideDialog())}})})}):a.hide();var r=h.plugin.getSelectedFlash();if(r){var u=s.mediaAttrs(r.attr("data-ke-tag"));n.val(u.src),o.val(s.removeUnit(r.css("width"))||u.width||0),d.val(s.removeUnit(r.css("height"))||u.height||0)}n[0].focus(),n[0].select()},delete:function(){h.plugin.getSelectedFlash().remove(),h.addBookmark()}},h.clickToolbar(p,h.plugin.flash.edit)});