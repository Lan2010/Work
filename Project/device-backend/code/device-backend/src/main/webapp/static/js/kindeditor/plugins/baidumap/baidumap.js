KindEditor.plugin("baidumap",function(r){var l=this,p="baidumap",u=l.lang(p+"."),h=r.undef(l.mapWidth,558),v=r.undef(l.mapHeight,360);l.clickToolbar(p,function(){var o,e,a=['<div style="padding:10px 20px;">','<div class="ke-header">','<div class="ke-left">',u.address+' <input id="kindeditor_plugin_map_address" name="address" class="ke-input-text" value="" style="width:200px;" /> ','<span class="ke-button-common ke-button-outer">','<input type="button" name="searchBtn" class="ke-button-common ke-button" value="'+u.search+'" />',"</span>","</div>",'<div class="ke-right">','<input type="checkbox" id="keInsertDynamicMap" name="insertDynamicMap" value="1" /> <label for="keInsertDynamicMap">'+u.insertDynamicMap+"</label>","</div>",'<div class="ke-clearfix"></div>',"</div>",'<div class="ke-map" style="width:'+h+"px;height:"+v+'px;"></div>',"</div>"].join(""),i=l.createDialog({name:p,width:h+42,title:l.lang(p),body:a,yesBtn:{name:l.lang("yes"),click:function(e){var a=o.map,i=a.getCenter(),t=i.lng+","+i.lat,n=a.getZoom(),d=[s[0].checked?l.pluginsPath+"baidumap/index.html":"http://api.map.baidu.com/staticimage","?center="+encodeURIComponent(t),"&zoom="+encodeURIComponent(n),"&width="+h,"&height="+v,"&markers="+encodeURIComponent(t),"&markerStyles="+encodeURIComponent("l,A")].join("");s[0].checked?l.insertHtml('<iframe src="'+d+'" frameborder="0" style="width:'+(h+2)+"px;height:"+(v+2)+'px;"></iframe>'):l.exec("insertimage",d),l.hideDialog().focus()}},beforeRemove:function(){d.remove(),e&&e.write(""),c.remove()}}),t=i.div,n=r('[name="address"]',t),d=r('[name="searchBtn"]',t),s=r('[name="insertDynamicMap"]',i.div),c=r('<iframe class="ke-textarea" frameborder="0" src="'+l.pluginsPath+'baidumap/map.html" style="width:'+h+"px;height:"+v+'px;"></iframe>');function m(){o=c[0].contentWindow,e=r.iframeDoc(c)}c.bind("load",function(){c.unbind("load"),r.IE?m():setTimeout(m,0)}),r(".ke-map",t).replaceWith(c),d.click(function(){o.search(n.val())})})});