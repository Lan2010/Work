define(["jquery","Global","Menu","Validate","DTP"],function(i,n,a,e,t){"use strict";var o,s,p=function(){!function(){i("#model").setSelect({url:n.path+"/api/device/modelList",id:"code",name:"name"});i("#plugin").setSelect({url:n.path+"/api/ipk/ipkNamelist",id:"ipkNameId",name:"ipkNickName"})}(),o.find("div.fileupload").fileupload(),s=o.validate(),o.on("submit",function(){if(s.form()){n.$page.msg("loading",{text:"添加中"});var a="/api/ipk/upload";return i.ajax({url:n.path+a,type:"post",data:new FormData(o.get(0)),processData:!1,contentType:!1,dataType:"json",success:function(e){n.checkJson(e)&&(n.$page.msg("success",{text:"添加成功。 可继续添加或返回",time:3e3}),o.get(0).reset())},error:function(e,t){n.$page.msg("error",{text:a+" - "+e.status+" - "+e.statusText+" - "+t})}}),!1}})};return{onSearch:function(e,t){},onLoad:function(e,t){a.active("plugin/list"),n.$page.addClass("page-gray"),o=i("#formAdd"),p()}}});