define(["jquery","Global","Menu","Route","TSearch","Grid","DTP","Modal"],function(s,o,i,c,d,t,a,e){"use strict";var l,u=!0,f=function(){var t=s(this).data("id");if(t&&confirm("确定删除吗？")){o.$page.msg("loading",{text:"删除中"});var e="/api/shell/delete";s.ajax({url:o.path+e,data:{shellId:t},cache:!1,success:function(t){o.checkJson(t)&&(o.$page.msg("success",{text:"删除成功",time:2e3}),l.refresh())},error:function(t,a){o.$page.msg("error",{text:e+" - "+t.status+" - "+t.statusText+" - "+a})}})}};return{refresh:function(){l.refresh()},onSearch:function(t,a){u=!1,d.fillData(a),l.load(a||{})},onLoad:function(t,a){var e,n,r;i.active(t),e=a,n=s("#mainTable"),r="/api/shell/list",l=n.grid({url:o.path+r,data:e,columns:[{data:"orderNo",class:"td-sn",render:function(t,a,e,n){return n.pageSize*(n.page-1)+e}},{data:"shellName"},{data:"shellDesc"},{data:"addTime",render:function(t,a,e){return s.date(t).string}},{data:"user_name"},{data:"status",render:function(t,a,e){return t?'<span class="font-green">正常</span>':'<span class="font-gray">失效</span>'}},{data:"opt",class:"txt-c",render:function(t,a,e){return['<button type="button" class="btn default btn-del" data-id="'+a.shellId+'">删除</button>'].join("")}}],onSuccess:function(t,a){o.checkJson(a)&&(u&&c.updateHash(t),u=!0)},onError:function(t,a){s("body").msg("error",{text:r+" - "+t.status+" - "+t.statusText+" - "+a})}}),n.on("click",".btn-del",f),s("#addTime").datetimepicker({format:"yyyy-mm-dd",minView:2}),d.fillData(a),d.init({onSearch:function(t){l.load(t||{})},onFilter:function(t){l.load(t||{})},onClear:function(t){l.load(t||{})},onFiltClear:function(t){l.load(t||{})}})}}});