define(["jquery","Global","Menu","Route","TSearch","Grid","DTP","Modal"],function(s,o,d,i,c,a,t,e){"use strict";var l,u=!0;return{onSearch:function(a,t){u=!1,c.fillData(t),l.load(t||{})},onLoad:function(a,t){var e,r,n;d.active(a),e=t,r=s("#mainTable"),n="/api/firmware/tasklist",l=r.grid({url:o.path+n,data:e,type:"post",columns:[{data:"orderNo",class:"td-sn",render:function(a,t,e,r){return r.pageSize*(r.page-1)+e}},{data:"taskName",render:function(a,t){return'<a href="#fmwTask/detail?id='+t.firmwareTaskId+'" class="font-mac">'+a+"</a>"}},{data:"nickName"},{data:"version"},{data:"addTime",class:"txt-c",render:function(a,t,e){return s.date(a).ymd}},{data:"devTotal",class:"txt-c",render:function(a,t,e){return t.completedNum+" / "+a}},{data:"progress",class:"td-progress",render:function(a,t,e){var r=parseInt(t.completedNum/t.devTotal*100);return['<div class="progress">','<div class="progress-bar progress-bar-success progress-bar-striped '+(100!=r?"active":"")+'" style="width: '+r+'%;"></div>','<span class="rate">'+r+" %</span>","</div>"].join("")}},{data:"user_name"}],onSuccess:function(a,t){o.checkJson(t)&&(u&&i.updateHash(a),u=!0)},onError:function(a,t){s("body").msg("error",{text:n+" - "+a.status+" - "+a.statusText+" - "+t})}}),c.fillData(t),c.init({onSearch:function(a){l.load(a||{})},onFilter:function(a){l.load(a||{})},onClear:function(a){l.load(a||{})},onFiltClear:function(a){l.load(a||{})}})}}});