define(["jquery","Global","Menu","Validate","DTP"],function(i,r,t,e,a){"use strict";var n,o,s=function(){!function(){i("#model").setSelect({url:r.path+"/api/device/modelList",id:"code",name:"name"});i("#firmwareNameId").setSelect({url:r.path+"/api/firmware/firmwareNamelist",id:"firmwareNameId",name:"nickName"})}(),n.find("div.fileupload").fileupload(),o=n.validate(),n.on("submit",function(){if(o.form()){r.$page.msg("loading",{text:"添加中"});var t="/api/firmware/upload";return i.ajax({url:r.path+t,type:"post",data:new FormData(n.get(0)),processData:!1,contentType:!1,dataType:"json",success:function(e){r.checkJson(e)&&(r.$page.msg("success",{text:"添加成功。 可继续添加或返回",time:3e3}),n.get(0).reset())},error:function(e,a){r.$page.msg("error",{text:t+" - "+e.status+" - "+e.statusText+" - "+a})}}),!1}})};return{onSearch:function(e,a){},onLoad:function(e,a){t.active("firmware/list"),r.$page.addClass("page-gray"),n=i("#formAdd"),s()}}});