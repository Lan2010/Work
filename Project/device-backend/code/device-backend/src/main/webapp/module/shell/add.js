define(["jquery","Global","Menu","Validate","DTP"],function(n,s,a,e,t){"use strict";var o,i,r=function(){o.find("div.fileupload").fileupload(),i=o.validate(),o.on("submit",function(){if(i.form()){s.$page.msg("loading",{text:"添加中"});var a="/api/shell/upload";return n.ajax({url:s.path+a,type:"post",data:new FormData(o.get(0)),processData:!1,contentType:!1,dataType:"json",success:function(e){s.checkJson(e)&&(s.$page.msg("success",{text:"添加成功。 可继续添加或返回",time:3e3}),o.get(0).reset())},error:function(e,t){s.$page.msg("error",{text:a+" - "+e.status+" - "+e.statusText+" - "+t})}}),!1}})};return{onSearch:function(e,t){},onLoad:function(e,t){a.active("shell/list"),s.$page.addClass("page-gray"),o=n("#formAdd"),r()}}});