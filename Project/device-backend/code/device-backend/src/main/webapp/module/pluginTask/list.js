define(["jquery","Global","Menu","Route","TSearch","Grid","DTP","Modal"],function(s,o,d,i,c,a,e,t){"use strict";var u,l=!0;return{onSearch:function(a,e){l=!1,c.fillData(e),u.load(e||{})},onLoad:function(a,e){var t,r,n;d.active(a),t=e,r=s("#mainTable"),n="/api/ipk/ipkTasklist",u=r.grid({url:o.path+n,data:t,type:"post",columns:[{data:"orderNo",class:"td-sn",render:function(a,e,t,r){return r.pageSize*(r.page-1)+t}},{data:"taskName",render:function(a,e){return'<a href="#pluginTask/detail?id='+e.ipkTaskId+'" class="font-mac">'+a+"</a>"}},{data:"operateType",render:function(a,e,t){return(0===a?"升级":1===a&&"卸载")||""}},{data:"ipkNickName"},{data:"version"},{data:"addTime",class:"txt-c",render:function(a,e,t){return s.date(a).ymd}},{data:"devTotal",class:"txt-c",render:function(a,e,t){return e.completedNum+" / "+a}},{data:"progress",class:"td-progress",render:function(a,e,t){var r=parseInt(e.completedNum/e.devTotal*100);return['<div class="progress">','<div class="progress-bar progress-bar-success progress-bar-striped '+(100!=r?"active":"")+'" style="width: '+r+'%;"></div>','<span class="rate">'+r+" %</span>","</div>"].join("")}},{data:"user_name"}],onSuccess:function(a,e){o.checkJson(e)&&(l&&i.updateHash(a),l=!0)},onError:function(a,e){s("body").msg("error",{text:n+" - "+a.status+" - "+a.statusText+" - "+e})}}),c.fillData(e),c.init({onSearch:function(a){u.load(a||{})},onFilter:function(a){u.load(a||{})},onClear:function(a){u.load(a||{})},onFiltClear:function(a){u.load(a||{})}})}}});